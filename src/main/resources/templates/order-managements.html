<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StyleLegacy - Qu·∫£n L√Ω ƒê∆°n H√†ng</title>
    <link rel="stylesheet" href="/css/orders-management.css">
</head>
<body>
<div class="dashboard-container">
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <div th:replace="fragments/admin-sidebar :: sidebar"></div>


    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="sidebar-toggle" id="sidebarToggle">‚ò∞</button>
                <h1 class="header-title">Order Management</h1>
            </div>
            <div class="header-user">
                <span>Hello, Admin</span>
                <div class="user-avatar">A</div>
            </div>
        </header>

        <!-- Order Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">Total Order</div>
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)">üì¶</div>
                </div>
                <div class="stat-value" id="stat-total-orders">0</div>
                <!--                <div class="stat-change positive">+2 ƒë∆°n h√¥m nay</div>-->
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">Pending</div>
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%)">‚è≥</div>
                </div>
                <div class="stat-value" id="stat-pending-orders">0</div>
                <!--                <div class="stat-change positive">+1 so v·ªõi h√¥m qua</div>-->
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">Shipped</div>
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)">üöö</div>
                </div>
                <div class="stat-value" id="stat-shipping-orders">0</div>
                <!--                <div class="stat-change positive">Kh√¥ng ƒë·ªïi</div>-->
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-title">Cancelled</div>
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)">‚ùå</div>
                </div>
                <div class="stat-value" id="stat-cancelled-orders">0</div>
                <!--<div class="stat-change negative">+1 so v·ªõi h√¥m qua</div>-->
            </div>
        </div>

        <!-- Filters and Search -->
<!--        <div class="filter-section">-->
<!--            <div class="filter-group">-->
<!--                <input type="text" class="search-input" placeholder="Search......"-->
<!--                       id="searchInput">-->
<!--                <button class="search-btn" id="searchBtn">üîç</button>-->
<!--            </div>-->
<!--            <div class="filter-group">-->
<!--                <select class="filter-select" id="statusFilter">-->
<!--                    <option value="">All</option>-->
<!--                    <option th:each="status : ${orderStatus}" th:value="${status.id}" th:text="${status.statusName}">Ch·ªù-->
<!--                        x·ª≠ l√Ω-->
<!--                    </option>-->
<!--                </select>-->
<!--                <select class="filter-select" id="dateFilter">-->
<!--                    <option value="">Time</option>-->
<!--                    <option value="today">Today</option>-->
<!--                    <option value="week">This Week</option>-->
<!--                    <option value="month">This Month</option>-->
<!--                </select>-->
<!--            </div>-->
<!--        </div>-->

        <!-- Orders Table -->
        <div class="orders-container">
            <div class="table-header">
                <h3 class="table-title">List all Order</h3>
                <div class="table-actions">
                    <button class="action-btn bulk-action" id="bulkActionBtn" style="display: none;">
                        Thao t√°c v·ªõi <span id="selectedCount">0</span> ƒë∆°n h√†ng
                    </button>
                </div>
            </div>

            <div class="table-wrapper">
                <table class="orders-table" id="ordersTable">
                    <thead>
                    <tr>
                        <th>
                            <input type="checkbox" id="selectAll" class="checkbox" hidden="">
                        </th>
<!--                        class sortable-->
                        <th class="" data-sort="orderCode">
                            ID <span class="sort-icon"></span>
                        </th>
                        <th class="" data-sort="customer">
                            Customer <span class="sort-icon"></span>
                        </th>
                        <th>Product</th>
                        <th class="" data-sort="total">
                            Total Amount <span class="sort-icon"></span>
                        </th>
                        <th class="" data-sort="status">
                            Status <span class="sort-icon"></span>
                        </th>
                        <th class="" data-sort="date">
                            Created At <span class="sort-icon"></span>
                        </th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                    <tr th:each="order : ${orders}">
                        <td>
                            <input type="checkbox" class="checkbox order-checkbox" th:attr="data-order-id=${order.id}"
                                   hidden="">
                        </td>
                        <td th:text="${order.displayCode}">ORD001</td>
                        <td th:text="${order.user.fullName}">Nguy·ªÖn VƒÉn A</td>
                        <td>
                            <div class="product-list">
                                <div th:each="detail : ${orderDetailsMap[order.id]}" class="product-item">
                                    <span th:text="${detail.product.productName}"></span>
                                    x
                                    <span th:text="${detail.quantity}"></span>
                                </div>
                            </div>
                        </td>

                        <td th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'POINT', 0, 'COMMA')} + ' VNƒê'">
                            ‚Ç´850,000
                        </td>
                        <td>
                            <span th:text="${order.status.statusName}"
                                  th:classappend="${order.status.cssClass}"
                                  class="status-badge">Pending
                            </span>
                        </td>
                        <td th:text="${#dates.format(order.orderDate, 'dd/MM/yyyy ''at'' HH:mm')}">30/07/2025</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-sm btn-primary"
                                        th:onclick="'viewOrderDetail(' + ${order.id} + ')'">View
                                </button>

                                <button class="btn-sm btn-success"
                                        th:if="${order.status.statusName == 'Pending'}"
                                        th:attr="onclick=|updateOrderStatus(${order.id}, 'confirmed')|"
                                        th:attrappend="data-action='confirmed-' + ${order.id}">
                                    Handle
                                </button>

                                <button class="btn-sm btn-danger"
                                        th:if="${order.status.statusName == 'Pending' or order.status.statusName == 'Confirmed'}"
                                        th:attr="onclick=|updateOrderStatus(${order.id}, 'cancelled')|"
                                        th:attrappend="data-action='cancelled-' + ${order.id}">
                                    Cancel
                                </button>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
<!--            <div class="pagination-container">-->
<!--                <div class="pagination-info">-->
<!--                    &lt;!&ndash;                    Hi·ªÉn th·ªã <span id="showingStart">1</span>-<span id="showingEnd">5</span>&ndash;&gt;-->
<!--                    &lt;!&ndash;                    trong t·ªïng s·ªë <span id="totalOrders">5</span> ƒë∆°n h√†ng&ndash;&gt;-->
<!--                </div>-->
<!--                <div class="pagination">-->
<!--                    <button class="pagination-btn" id="prevPage" disabled>‚Äπ</button>-->
<!--                    <div class="pagination-numbers" id="paginationNumbers">-->
<!--                        <button class="pagination-number active">1</button>-->
<!--                    </div>-->
<!--                    <button class="pagination-btn" id="nextPage" disabled>‚Ä∫</button>-->
<!--                </div>-->
<!--            </div>-->
        </div>

        <!-- Order Detail Modal -->
        <div class="modal-overlay" id="orderDetailModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>Order Details</h2>
                    <button class="modal-close" id="closeModal">‚úï</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Order details will be populated by JavaScript -->
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" id="cancelModalBtn">Close</button>
                    <button class="btn-primary" id="updateOrderBtn">Save</button>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Success/Error Messages -->
<div class="toast" id="toast">
    <div class="toast-content">
        <span class="toast-icon">‚úì</span>
        <span class="toast-message">Thao t√°c th√†nh c√¥ng!</span>
    </div>
</div>

<script src="/js/order-management.js"></script>
</body>
</html>